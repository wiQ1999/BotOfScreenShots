[{"References":["System.dll","System.Threading.dll","System.Windows.Forms.dll","BotOfScreenShots_Algorithms.dll","System.Drawing.dll","System.Runtime.InteropServices.dll"],"Code":"//OPIS\r\n//Do poprawnego działania tego profilu należy wykonać SS aplikacji, którą będzie \r\n//monitorować program na dolnym pasku windows oraz ckontrolki zamykającej tę\r\n//aplikację. Domyślnie konfiguracją zakłada monitorowanie aplikacji google //chrome oraz wyświetlanie okna przy wykryciu jej aktywności, a nastepnie //sprawdzenie wprowadzonego hasła - przy błędnym aplikacja zostaje zamknięta.\r\n\r\n//Hasło uwierzytelniające dostęp do aplikacji\r\nconst string PASSWORD = \"zaq1@WSX\";\r\n//Interwał sprawdzania aplikacji na pasku menu\r\nconst int LOOPTIME = 3000;\r\n\r\n//Punkt wejścia\r\npublic static void Main()\r\n{\r\n\tbool appIsActive = false;\r\n\twhile (true)\r\n\t{\r\n\t\tThread.Sleep(LOOPTIME);\r\n\t\tvar point = SameImage.Find((Bitmap)Bitmap.FromFile(Path + \"Chrome1.png\"), new Rectangle(0, SameImage.WorkArea.Height - 100, SameImage.WorkArea.Width, 100));\r\n\t\tif (point != null && !appIsActive)\r\n\t\t{\r\n\t\t\tDialogResult dialog = RegisterBox.Show();\r\n        \t\tif (dialog == DialogResult.OK)\r\n        \t\t{\r\n            \t\t\tif (RegisterBox.passwordTextBox.Text != PASSWORD)\r\n\t\t\t\t{\r\n\t\t\t\t\tCancelAplication();\r\n\t\t\t\t\tappIsActive = false;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tappIsActive = true;\r\n\t\t\t\t}\r\n        \t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tCancelAplication();\r\n\t\t\t\tappIsActive = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tappIsActive = false;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//Zamykanie aplikacji\r\nprivate static void CancelAplication()\r\n{\r\n\tPoint? point = null;\r\n\tint searchLoops = 5;\r\n\tfor (int loop = 0; loop < searchLoops; loop++)\r\n\t{\r\n\t\tpoint = SameImage.Find((Bitmap)Bitmap.FromFile(Path + \"ExitButton1.png\"));\r\n\t\tif (point != null)\r\n\t\t{\r\n\t\t\tPoint tempPoint = (Point)point;\r\n\t\t\tCursor.Position = new Point(tempPoint.X, tempPoint.Y);\r\n\t\t\tMouseClick();\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\t\r\n}\r\n\r\n//Okno interakcji\r\npublic class RegisterBox\r\n{\r\n\tpublic static Form MainForm = new Form();\r\n\tpublic static TextBox passwordTextBox;\r\n        private RegisterBox() { }\r\n\r\n        private static void BuildForm()\r\n        {\r\n\t    MainForm = new Form();\r\n            MainForm.Width = 300;\r\n            MainForm.Height = 220;\r\n            MainForm.MaximumSize = new Size\r\n\t\t(MainForm.Width, MainForm.Height);\r\n            MainForm.MinimumSize = new Size\r\n\t\t(MainForm.Width, MainForm.Height);\r\n            MainForm.MinimizeBox = false;\r\n            MainForm.MaximizeBox = false;\r\n            MainForm.Text = \"Register\";\r\n\r\n            Label passwordLabel = new Label\r\n            {\r\n                Text = \"Password:\",\r\n                Location = new Point(0, 10)\r\n            };\r\n            passwordTextBox = new TextBox\r\n            {\r\n                Width = 300,\r\n                Location = new Point(0, 35),\r\n\t\tPasswordChar = '*'\r\n            };\r\n            Label textLabel = new Label\r\n            {\r\n                Text = \"Destination:\",\r\n                Location = new Point(0, 70)\r\n            };\r\n            TextBox textBox = new TextBox\r\n            {\r\n                Width = 300,\r\n                Height = 50,\r\n                Multiline = true,\r\n                Location = new Point(0, 95)\r\n            };\r\n            Button saveButton = new Button\r\n            {\r\n                Width = 300,\r\n                Text = \"CHECK\",\r\n                Location = new Point(0, 155),\r\n                DialogResult = DialogResult.OK\r\n            };\r\n\r\n            MainForm.Controls.Add(passwordLabel);\r\n            MainForm.Controls.Add(passwordTextBox);\r\n            MainForm.Controls.Add(textLabel);\r\n            MainForm.Controls.Add(textBox);\r\n            MainForm.Controls.Add(saveButton);\r\n        }\r\n\r\n        public static DialogResult Show()\r\n        {\r\n            BuildForm();\r\n            return MainForm.ShowDialog();\r\n        }\r\n    }","Id":1,"Name":"Sample-Security","WorkArea":"0, 0, 1920, 1080","IsPreview":true,"IsDeveloperMode":false}]